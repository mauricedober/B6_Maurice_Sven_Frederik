<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kaffee Shop</title>
    <link href="https://unpkg.com/@tabler/core@latest/dist/css/tabler.min.css" rel="stylesheet" />
    <style>
      /* Farbvariablen gemäß gewünschtem Farbschema */
      :root {
        --color-light-foam: #f4f1ee;    /* Milchschaum */
        --color-crema: #d7b899;         /* Crema-Ton */
        --color-cappuccino: #b88a58;    /* Cappuccino-Braun */
        --color-espresso: #6e3b24;      /* Espresso */
        --color-dark-roast: #3e1e14;    /* Dunkel gerösteter Kaffee */

        /* Default Theme Override */
        --tblr-body-bg: var(--color-light-foam);
        --tblr-primary: var(--color-cappuccino);
        --tblr-secondary: var(--color-crema);
        --tblr-dark: var(--color-dark-roast);
        --tblr-muted: var(--color-espresso);
      }

      /* Hero-Bereich mit Hintergrundfarbe */
      .hero {
        background-image: url(../media/hero.jpeg);
        padding: 4rem 2rem;
        text-align: left;
      }

      /* Produktkarten: Platzhalter für Bild */
      .product-card img {
        width: 100%;
        height: auto;
        background-color: var(--color-sand);
        aspect-ratio: 1/1;
      }

      /* Gewinnspielbox mit Kontrast und Rahmen */
      .promo-box {
        border: 2px solid var(--color-espresso);
        padding: 2rem;
        text-align: center;
        border-radius: 8px;
        background-color: #fff;
      }

      .promo-box input {
        margin-top: 1rem;
        margin-bottom: 1rem;
      }

      /* Footer optisch abheben */
      footer {
        background: var(--color-beige);
        padding: 2rem;
        border-top: 1px solid var(--color-sand);
      }
      .navbar-brand img{
        height: 7vh;
      }

      footer img{
        height: 7vh;
      }

      .machine {
      margin: 2em auto;
      display: flex;
      justify-content: center;
      gap: 1em;
    }
    .reel {
      background: #222;
      width: 60px;
      height: 60px;
      font-size: 2em;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid #fff;
      border-radius: 10px;
    }
    .spin {
      animation: spin 0.5s infinite;
    }
    @keyframes spin {
      0% { transform: rotateX(0deg); }
      100% { transform: rotateX(360deg); }
    }
    .result {
      margin-top: 1.5em;
      font-size: 1.3em;
      color: #00e676;
    } 
    </style>
  </head>
  <body>
    <header class="navbar navbar-expand-lg navbar-light">
      <div class="container-xl">
        <a href="#" class="navbar-brand"><img src="../media/logo.svg"></a>
        <div class="navbar-nav flex-row ms-auto">
          <a class="nav-link" href="#">Produkte</a>
          <a class="nav-link" href="#">Gewinnspiel</a>
          <a class="nav-link" href="#">Über uns</a>
          <a class="nav-link" href="#">Warenkorb</a>
        </div>
      </div>
    </header>

    <section class="hero">
      <div class="container-xl">
        <h1 class="display-4 fw-bold text-light">Kaffee.<br />Handwerk.<br />Leidenschaft.</h1>
        <a href="#" class="btn btn-light mt-3 text-dark">Sortiment entdecken →</a>
      </div>
    </section>

    <section class="py-5">
      <div class="container-xl">
        <h2 class="mb-4">Bestseller</h2>
        <div class="row g-4">
          <div class="col-sm-6 col-md-4">
            <div class="card product-card">
              <img alt="Produkt" />
              <div class="card-body">
                <h3 class="card-title">Produktname</h3>
                <span class="badge bg-secondary text-light">Herkunftsland</span>
                <span class="badge bg-secondary text-light">Aroma</span>
              </div>
            </div>
          </div>
          <div class="col-sm-6 col-md-4">
            <div class="card product-card">
              <img alt="Produkt" />
              <div class="card-body">
                <h3 class="card-title">Produktname</h3>
                <span class="badge bg-secondary text-light">Herkunftsland</span>
                <span class="badge bg-secondary text-light">Aroma</span>
              </div>
            </div>
          </div>
          <div class="col-sm-6 col-md-4">
            <div class="card product-card">
              <img alt="Produkt" />
              <div class="card-body">
                <h3 class="card-title">Produktname</h3>
                <span class="badge bg-secondary text-light">Herkunftsland</span>
                <span class="badge bg-secondary text-light">Aroma</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="py-5 bg-white">
      <div class="container-xl">
        <h2>Über unseren Shop</h2>
        <p>Fugiat minim incididunt aliquip ut est aliquip deserunt anim nisi eu sit id id.</p>
        <p>Magna commodo non voluptate quis esse consectetur elit deserunt adipisicing id.</p>
        <p>Amet sint et laboris consectetur et aute adipisicing.</p>
      </div>
    </section>

    <section class="py-5">
      <div class="container">
    <div class="row justify-content-center">
      <div class="col-md-6 col-lg-5">
        <div class="card shadow-lg">
          <div class="card-body">
            <h1 class="card-title text-center mb-4">Dreh & Gewinne 🎰</h1>
            <form id="entryForm" class="mb-3">
              <div class="mb-3 row">
                <div class="col">
                  <input type="text" id="firstname" class="form-control" placeholder="Vorname" required>
                </div>
                <div class="col">
                  <input type="text" id="lastname" class="form-control" placeholder="Nachname" required>
                </div>
              </div>
              <div class="mb-3">
                <input type="email" id="email" class="form-control" placeholder="Deine E-Mail" required>
              </div>
              <div class="mb-3">
                <input type="tel" id="phone" class="form-control" placeholder="Telefonnummer" required>
              </div>
              <div class="mb-3">
                <input type="text" id="location" class="form-control" placeholder="Wohngemeinde, PLZ" required>
              </div>
              <div class="mb-3">
                <input type="date" id="dob" class="form-control" placeholder="Geburtsdatum" required>
              </div>
              <div class="d-grid">
                <button type="button" class="btn btn-primary" onclick="startSpin()">Jetzt drehen!</button>
              </div>
            </form>
            <div class="machine mb-3">
              <div id="reel1" class="reel">❓</div>
              <div id="reel2" class="reel">❓</div>
              <div id="reel3" class="reel">❓</div>
            </div>
            <div id="result" class="result text-center"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Tabler JS (optional, for some components) -->
  <script src="https://unpkg.com/@tabler/core@latest/dist/js/tabler.min.js"></script>
  <script>
    const symbols = ["🎁", "🔥", "💰", "🍀"];
    const rewards = {
      "🎁🎁🎁": "10% Rabatt",
      "🔥🔥🔥": "20% Rabatt",
      "💰💰💰": "Gratis Versand",
      "🍀🍀🍀": "Ein Gratis-Artikel!"
    };

    function generateCode(prefix) {
      const random = Math.random().toString(36).substring(2, 6).toUpperCase();
      return `${prefix}-${random}`;
    }

    function validateEmail(email) {
      // Einfache E-Mail-Validierung: enthält @ und .
      return /\S+@\S+\.\S+/.test(email);
    }

    function validateName(name) {
      // Nur Buchstaben, mindestens 2 Zeichen
      return /^[A-Za-zÄÖÜäöüß\- ]{2,}$/.test(name);
    }

    function validatePhone(phone) {
      // Mindestens 6 Ziffern, erlaubt +, Leerzeichen, -, ()
      return /^[\d\+\-\(\) ]{6,}$/.test(phone);
    }

    function validateLocation(location) {
      // Mindestens 3 Zeichen, Buchstaben, Ziffern, Leerzeichen, Komma
      return /^[A-Za-zÄÖÜäöüß0-9 ,\-]{3,}$/.test(location);
    }

    function validatePLZ(location) {
      // Extrahiere PLZ am Ende (letzte 4 oder 5 Ziffern)
      const match = location.match(/(\d{4,5})$/);
      return match ? true : false;
    }

    function validateDOB(dob) {
      // Muss gesetzt sein und Nutzer mindestens 18 Jahre alt
      if (!dob) return false;
      const birth = new Date(dob);
      const today = new Date();
      const age = today.getFullYear() - birth.getFullYear();
      const m = today.getMonth() - birth.getMonth();
      if (m < 0 || (m === 0 && today.getDate() < birth.getDate())) {
        return age - 1 >= 18;
      }
      return age >= 18;
    }

    function startSpin() {
      const firstname = document.getElementById("firstname").value.trim();
      const lastname = document.getElementById("lastname").value.trim();
      const email = document.getElementById("email").value.trim();
      const phone = document.getElementById("phone").value.trim();
      const location = document.getElementById("location").value.trim();
      const dob = document.getElementById("dob").value;

      const resultDiv = document.getElementById("result");

      // Validierungen
      if (!validateName(firstname)) {
        alert("Bitte einen gültigen Vornamen eingeben (nur Buchstaben, mindestens 2 Zeichen).");
        return;
      }
      if (!validateName(lastname)) {
        alert("Bitte einen gültigen Nachnamen eingeben (nur Buchstaben, mindestens 2 Zeichen).");
        return;
      }
      if (!validateEmail(email)) {
        alert("Bitte eine gültige E-Mail-Adresse eingeben.");
        return;
      }
      if (!validatePhone(phone)) {
        alert("Bitte eine gültige Telefonnummer eingeben (mind. 6 Ziffern).");
        return;
      }
      if (!validateLocation(location)) {
        alert("Bitte eine gültige Wohngemeinde/PLZ eingeben.");
        return;
      }
      if (!validatePLZ(location)) {
        alert("Bitte geben Sie am Ende der Wohngemeinde eine gültige Postleitzahl (4 oder 5 Ziffern) an.");
        return;
      }
      if (!validateDOB(dob)) {
        alert("Bitte ein gültiges Geburtsdatum eingeben (mindestens 18 Jahre alt).");
        return;
      }

      if (localStorage.getItem("hasSpun") === "true") {
        resultDiv.textContent = "🚫 Du hast bereits einmal gedreht!";
        return;
      }

      resultDiv.textContent = "";

      const reel1 = document.getElementById("reel1");
      const reel2 = document.getElementById("reel2");
      const reel3 = document.getElementById("reel3");

      [reel1, reel2, reel3].forEach(r => r.classList.add("spin"));

      setTimeout(() => {
        [reel1, reel2, reel3].forEach(r => r.classList.remove("spin"));

        const s1 = symbols[Math.floor(Math.random() * symbols.length)];
        const s2 = symbols[Math.floor(Math.random() * symbols.length)];
        const s3 = symbols[Math.floor(Math.random() * symbols.length)];

        reel1.textContent = s1;
        reel2.textContent = s2;
        reel3.textContent = s3;

        const combo = s1 + s2 + s3;
        const win = rewards[combo];

        if (win) {
          const code = generateCode("SAVE");
          resultDiv.textContent = `🎉 ${win} – Dein Rabattcode: ${code}`;
        } else {
          resultDiv.textContent = "Leider kein Gewinn 😢 Versuche es später nochmal!";
        }

        localStorage.setItem("hasSpun", "true");

        console.log("Teilnehmer:", {
          firstname, lastname, email, phone, location, dob, combo, win: win || "Keiner"
        });
      }, 2000);
    }
  </script>
    </section>

    <footer>
      <div class="container-xl">
        <div class="row">
          <div class="col-md-3 mb-3">
            <img src="../media/logo.svg">
          </div>
          <div class="col-md-3 mb-3">
            <h5>Menu</h5>
            <ul class="list-unstyled">
              <li><a href="#">Produkte</a></li>
              <li><a href="#">Über uns</a></li>
            </ul>
          </div>
          <div class="col-md-3 mb-3">
            <ul class="list-unstyled">
              <li><a href="#">Gewinnspiel</a></li>
              <li><a href="#">Impressum</a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>

    <script src="https://unpkg.com/@tabler/core@latest/dist/js/tabler.min.js"></script>
  </body>
</html>
